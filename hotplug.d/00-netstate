[ ifup = "$ACTION" ] && {
        uci_toggle_state network "$INTERFACE" up 1
        [ -n "$DEVICE" ] && {
                uci_toggle_state network "$INTERFACE" ifname "$DEVICE"
        }
}



sleep 50
#ip link set sfp1 xdp obj /etc/ebpf/xdp_le_ipv4_forward.o  sec ipv4_forward
#ip link set wan xdp obj /etc/ebpf/xdp_le_ipv4_forward.o  sec ipv4_forward
#ip link set cloud xdp obj /etc/ebpf/xdp_le_ipv4_forward.o  sec ipv4_forward
#ip link set ifb4cloud xdp obj /etc/ebpf/xdp_le_ipv4_forward.o  sec ipv4_forward
#ip link set pppoe-wan xdp obj /etc/ebpf/xdp_le_ipv4_forward.o  sec ipv4_forward

ethtool -K sfp1 rx-udp-gro-forwarding off rx-gro-list off gro off tx-vlan-offload off hw-tc-offload off
ethtool -K lan1 rx-udp-gro-forwarding off rx-gro-list off gro off tx-vlan-offload off hw-tc-offload off
ethtool -K lan2 rx-udp-gro-forwarding off rx-gro-list off gro off tx-vlan-offload off hw-tc-offload off
ethtool -K lan3 rx-udp-gro-forwarding off rx-gro-list off gro off tx-vlan-offload off hw-tc-offload off
ethtool -K lan4 rx-udp-gro-forwarding off rx-gro-list off gro off tx-vlan-offload off hw-tc-offload off
ethtool -K phy0-ap0 rx-udp-gro-forwarding off rx-gro-list off gro off tx-vlan-offload off hw-tc-offload off
ethtool -K phy1-ap0 rx-udp-gro-forwarding off rx-gro-list off gro off tx-vlan-offload off hw-tc-offload off
ethtool -K cloud rx-udp-gro-forwarding off rx-gro-list off gro off tx-vlan-offload off hw-tc-offload off
ethtool -K pppoe-wan rx-udp-gro-forwarding off rx-gro-list off gro off tx-vlan-offload off hw-tc-offload off
ethtool -K wan rx-udp-gro-forwarding off rx-gro-list off gro off tx-vlan-offload off hw-tc-offload off

ethtool --offload sfp1 tso off
ethtool --offload lan1 tso off
ethtool --offload lan2 tso off
ethtool --offload lan3 tso off
ethtool --offload lan4 tso off
ethtool --offload phy0-ap0 tso off
ethtool --offload phy1-ap0 tso off
ethtool --offload cloud tso off
ethtool --offload pppoe-wan tso off

echo '2000000000' > /proc/sys/kernel/shmall
echo '2000000000' > /proc/sys/kernel/shmmax

echo 0 > /proc/sys/vm/vfs_cache_pressure

alias apk="apk --allow-untrusted"

#1879048192
#echo '5000' | tee /sys/class/net/*/queues/tx-*/byte_queue_limits/limit
#echo '50000' | tee /sys/class/net/*/queues/tx-*/byte_queue_limits/limit_max
#echo '5000' | tee /sys/class/net/*/queues/tx-*/byte_queue_limits/limit_min

echo '1879048192' | tee /sys/class/net/*/queues/tx-*/byte_queue_limits/limit
echo '1879048192' | tee /sys/class/net/*/queues/tx-*/byte_queue_limits/limit_max
echo '1879048192' | tee /sys/class/net/*/queues/tx-*/byte_queue_limits/limit_min

echo '500' > /proc/sys/net/ipv4/tcp_limit_output_bytes

ethtool -A sfp1 autoneg off
ethtool -A lan1 autoneg off
ethtool -A lan2 autoneg off
ethtool -A lan3 autoneg off
ethtool -A lan4 autoneg off

echo f | tee /sys/class/net/*/queues/rx-0/rps_cpus

